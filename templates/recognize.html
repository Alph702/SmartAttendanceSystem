{% extends "base.html" %} {% block content %}
<!-- Back Button (Mobile Only via CSS) -->
<a href="/" class="fullscreen-back-btn">
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
    stroke-linecap="round"
    stroke-linejoin="round"
  >
    <path d="M19 12H5" />
    <path d="M12 19l-7-7 7-7" />
  </svg>
</a>

<!-- Status Pill -->
<div class="status-pill">
  <span
    id="systemStatus"
    style="color: var(--success); font-weight: 600; font-size: 0.85rem"
    >‚óè Connecting...</span
  >
</div>

<div class="container" id="mainContainer">
  <!-- Header (Hidden on Mobile Fullscreen via CSS) -->
  <div
    class="desktop-header"
    style="
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 1rem;
    "
  >
    <h2>Live Attendance</h2>
  </div>

  <!-- Video Container -->
  <div class="fullscreen-video-container">
    <video id="videoElement" autoplay playsinline muted></video>
    <canvas id="overlayCanvas"></canvas>
    <canvas id="captureCanvas" style="display: none"></canvas>
  </div>

  <!-- Controls / Info -->
  <div
    class="bottom-sheet"
    style="
      padding-top: 1.5rem;
      padding-bottom: max(1.5rem, env(safe-area-inset-bottom));
    "
  >
    <div style="text-align: center">
      <h3 style="color: white; font-size: 1.1rem; margin-bottom: 0.2rem">
        Live Attendance
      </h3>
      <p style="color: var(--text-muted); font-size: 0.9rem">
        Look at the camera to mark presence.
      </p>
    </div>
  </div>
</div>

<!-- Success Modal -->
<div
  id="successModal"
  style="
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 2000;
    align-items: center;
    justify-content: center;
  "
>
  <div
    id="modalPanel"
    class="glass-panel"
    style="
      padding: 2rem;
      text-align: center;
      max-width: 90%;
      width: 400px;
      border-color: var(--success);
      box-shadow: 0 0 50px rgba(0, 255, 127, 0.2);
    "
  >
    <div
      id="modalIcon"
      style="
        width: 60px;
        height: 60px;
        background: var(--success);
        border-radius: 50%;
        margin: 0 auto 1.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
      "
    >
      <svg
        width="32"
        height="32"
        viewBox="0 0 24 24"
        fill="none"
        stroke="black"
        stroke-width="3"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
    </div>
    <h2 id="modalTitle" style="color: var(--success); margin-bottom: 0.5rem">
      Marked!
    </h2>
    <p
      id="modalMessage"
      style="
        font-size: 1.5rem;
        font-weight: 700;
        color: white;
        margin-bottom: 2rem;
      "
    >
      User Name
    </p>
    <button
      id="modalButton"
      onclick="closeModal(true)"
      class="btn btn-primary"
      style="background: var(--success); width: 100%; border: none"
    >
      OK
    </button>
  </div>
</div>

<script src="{{ url_for('static', filename='js/recognize.js') }}"></script>
{% endblock %}
